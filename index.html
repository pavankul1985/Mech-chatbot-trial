<script>
  // Load .docx content using Mammoth.js
  function loadDocx() {
    fetch('myknowledge.docx')  // Make sure the .docx file is in the root of your repo
      .then(response => response.arrayBuffer())
      .then(data => {
        console.log("Fetched .docx file successfully."); // Log fetch success
        mammoth.extractRawText({ arrayBuffer: data })
          .then(function(result) {
            console.log("Extracted text from .docx file:", result.value); // Log extracted text
            // Store the .docx content in a global variable for later use
            window.docxContent = result.value;
            displayMessage("AI Bot: Hello! Ask me anything.");
          })
          .catch(error => console.error('Error extracting text from .docx:', error)); // Log extraction errors
      })
      .catch(error => console.error('Error loading .docx file:', error)); // Log fetch errors
  }

  // Display user and bot messages
  function displayMessage(message) {
    const chatbox = document.getElementById('chatbox');
    chatbox.innerHTML += '<div>' + message + '</div>';
    chatbox.scrollTop = chatbox.scrollHeight;
  }

  // Send user input and show AI response
  function sendMessage() {
    const userInput = document.getElementById('userInput').value;
    if (userInput.trim() !== '') {
      displayMessage('You: ' + userInput);
      document.getElementById('userInput').value = '';

      // AI response logic based on user input
      let response = "AI Bot: Here's what I found in my knowledge base.";

      // Check for certain keywords and show relevant content from the .docx file
      if (userInput.toLowerCase().includes("help")) {
        response = "AI Bot: I can assist you with information from my knowledge base.";
      } else if (userInput.toLowerCase().includes("info")) {
        response = "AI Bot: Here's some information: " + window.docxContent.substring(0, 200) + '...';  // Show first 200 chars
      } else {
        response = "AI Bot: I couldn't find specific info. Here's some general knowledge: " + window.docxContent.substring(0, 200) + '...';
      }

      displayMessage(response);
    }
  }

  // Initialize the page by loading the .docx content
  loadDocx();
</script>
